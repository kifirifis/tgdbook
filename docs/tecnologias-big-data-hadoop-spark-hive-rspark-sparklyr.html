<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6.1 Tecnologías Big Data (Hadoop, Spark, Hive, Rspark, Sparklyr) | Prácticas de Tecnologías de Gestión y Manipulación de Datos</title>
  <meta name="description" content="Prácticas de la asignatura de Tecnologías de Gestión de Datos del Máster en Técnicas Estadísticas." />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="6.1 Tecnologías Big Data (Hadoop, Spark, Hive, Rspark, Sparklyr) | Prácticas de Tecnologías de Gestión y Manipulación de Datos" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Prácticas de la asignatura de Tecnologías de Gestión de Datos del Máster en Técnicas Estadísticas." />
  <meta name="github-repo" content="gltaboada/tgdbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6.1 Tecnologías Big Data (Hadoop, Spark, Hive, Rspark, Sparklyr) | Prácticas de Tecnologías de Gestión y Manipulación de Datos" />
  
  <meta name="twitter:description" content="Prácticas de la asignatura de Tecnologías de Gestión de Datos del Máster en Técnicas Estadísticas." />
  

<meta name="author" content="Guillermo López Taboada (guillermo.lopez.taboada@udc.es) y Rubén F. Casal (ruben.fcasal@udc.es)" />


<meta name="date" content="2020-09-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tecnologias-para-el-tratamiendo-de-datos-masivos.html"/>
<link rel="next" href="visualizacion-y-generacion-de-cuadros-de-mando.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Prácticas de TGD</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prólogo</a></li>
<li class="chapter" data-level="1" data-path="introduccion-a-las-tecnologias-de-gestion-y-manipulacion-de-datos.html"><a href="introduccion-a-las-tecnologias-de-gestion-y-manipulacion-de-datos.html"><i class="fa fa-check"></i><b>1</b> Introducción a las Tecnologías de Gestión y Manipulación de Datos</a><ul>
<li class="chapter" data-level="1.1" data-path="contenidos.html"><a href="contenidos.html"><i class="fa fa-check"></i><b>1.1</b> Contenidos</a></li>
<li class="chapter" data-level="1.2" data-path="planificacion-tentativa.html"><a href="planificacion-tentativa.html"><i class="fa fa-check"></i><b>1.2</b> Planificación (tentativa)</a><ul>
<li class="chapter" data-level="1.2.1" data-path="planificacion-tentativa.html"><a href="planificacion-tentativa.html#evaluacion"><i class="fa fa-check"></i><b>1.2.1</b> Evaluación</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="fuentes-de-informacion.html"><a href="fuentes-de-informacion.html"><i class="fa fa-check"></i><b>1.3</b> Fuentes de información:</a><ul>
<li class="chapter" data-level="1.3.1" data-path="fuentes-de-informacion.html"><a href="fuentes-de-informacion.html#basica"><i class="fa fa-check"></i><b>1.3.1</b> Básica</a></li>
<li class="chapter" data-level="1.3.2" data-path="fuentes-de-informacion.html"><a href="fuentes-de-informacion.html#complementaria"><i class="fa fa-check"></i><b>1.3.2</b> Complementaria:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="manipulacion-de-datos-con-r.html"><a href="manipulacion-de-datos-con-r.html"><i class="fa fa-check"></i><b>2</b> Manipulación de datos con R</a><ul>
<li class="chapter" data-level="2.1" data-path="lectura-importacion-y-exportacion-de-datos.html"><a href="lectura-importacion-y-exportacion-de-datos.html"><i class="fa fa-check"></i><b>2.1</b> Lectura, importación y exportación de datos</a><ul>
<li class="chapter" data-level="2.1.1" data-path="lectura-importacion-y-exportacion-de-datos.html"><a href="lectura-importacion-y-exportacion-de-datos.html#formato-de-datos-de-r"><i class="fa fa-check"></i><b>2.1.1</b> Formato de datos de R</a></li>
<li class="chapter" data-level="2.1.2" data-path="lectura-importacion-y-exportacion-de-datos.html"><a href="lectura-importacion-y-exportacion-de-datos.html#acceso-a-datos-en-paquetes"><i class="fa fa-check"></i><b>2.1.2</b> Acceso a datos en paquetes</a></li>
<li class="chapter" data-level="2.1.3" data-path="lectura-importacion-y-exportacion-de-datos.html"><a href="lectura-importacion-y-exportacion-de-datos.html#cap2-texto"><i class="fa fa-check"></i><b>2.1.3</b> Lectura de archivos de texto</a></li>
<li class="chapter" data-level="2.1.4" data-path="lectura-importacion-y-exportacion-de-datos.html"><a href="lectura-importacion-y-exportacion-de-datos.html#alternativa-tidyverse"><i class="fa fa-check"></i><b>2.1.4</b> Alternativa <code>tidyverse</code></a></li>
<li class="chapter" data-level="2.1.5" data-path="lectura-importacion-y-exportacion-de-datos.html"><a href="lectura-importacion-y-exportacion-de-datos.html#importacion-desde-spss"><i class="fa fa-check"></i><b>2.1.5</b> Importación desde SPSS</a></li>
<li class="chapter" data-level="2.1.6" data-path="lectura-importacion-y-exportacion-de-datos.html"><a href="lectura-importacion-y-exportacion-de-datos.html#importacion-desde-excel"><i class="fa fa-check"></i><b>2.1.6</b> Importación desde Excel</a></li>
<li class="chapter" data-level="2.1.7" data-path="lectura-importacion-y-exportacion-de-datos.html"><a href="lectura-importacion-y-exportacion-de-datos.html#exportacion-de-datos"><i class="fa fa-check"></i><b>2.1.7</b> Exportación de datos</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="manipulacion-de-datos.html"><a href="manipulacion-de-datos.html"><i class="fa fa-check"></i><b>2.2</b> Manipulación de datos</a><ul>
<li class="chapter" data-level="2.2.1" data-path="manipulacion-de-datos.html"><a href="manipulacion-de-datos.html#operaciones-con-variables"><i class="fa fa-check"></i><b>2.2.1</b> Operaciones con variables</a></li>
<li class="chapter" data-level="2.2.2" data-path="manipulacion-de-datos.html"><a href="manipulacion-de-datos.html#operaciones-con-casos"><i class="fa fa-check"></i><b>2.2.2</b> Operaciones con casos</a></li>
<li class="chapter" data-level="2.2.3" data-path="manipulacion-de-datos.html"><a href="manipulacion-de-datos.html#funciones-apply"><i class="fa fa-check"></i><b>2.2.3</b> Funciones <code>apply</code></a></li>
<li class="chapter" data-level="2.2.4" data-path="manipulacion-de-datos.html"><a href="manipulacion-de-datos.html#operaciones-con-tablas-de-datos"><i class="fa fa-check"></i><b>2.2.4</b> Operaciones con tablas de datos</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="ejemplo-wos-data.html"><a href="ejemplo-wos-data.html"><i class="fa fa-check"></i><b>2.3</b> Ejemplo WoS data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduccion-al-lenguaje-sql.html"><a href="introduccion-al-lenguaje-sql.html"><i class="fa fa-check"></i><b>3</b> Introducción al lenguaje SQL</a><ul>
<li class="chapter" data-level="3.1" data-path="bases-de-datos-relacionales.html"><a href="bases-de-datos-relacionales.html"><i class="fa fa-check"></i><b>3.1</b> Bases de Datos Relacionales</a><ul>
<li class="chapter" data-level="3.1.1" data-path="bases-de-datos-relacionales.html"><a href="bases-de-datos-relacionales.html#definiciones"><i class="fa fa-check"></i><b>3.1.1</b> Definiciones</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="sintaxis-sql.html"><a href="sintaxis-sql.html"><i class="fa fa-check"></i><b>3.2</b> Sintaxis SQL</a><ul>
<li class="chapter" data-level="3.2.1" data-path="sintaxis-sql.html"><a href="sintaxis-sql.html#extraccion-sql-11-statements"><i class="fa fa-check"></i><b>3.2.1</b> Extracción SQL (11 statements)</a></li>
<li class="chapter" data-level="3.2.2" data-path="sintaxis-sql.html"><a href="sintaxis-sql.html#crearactualizarborrar-tablas-sql-8-statements"><i class="fa fa-check"></i><b>3.2.2</b> Crear/Actualizar/Borrar tablas SQL (8 statements)</a></li>
<li class="chapter" data-level="3.2.3" data-path="sintaxis-sql.html"><a href="sintaxis-sql.html#anadiractualizarborrar-tuplas-en-sql-3-statements"><i class="fa fa-check"></i><b>3.2.3</b> Añadir/Actualizar/Borrar tuplas en SQL (3 statements)</a></li>
<li class="chapter" data-level="3.2.4" data-path="sintaxis-sql.html"><a href="sintaxis-sql.html#gestion-bases-de-datos-5-statements"><i class="fa fa-check"></i><b>3.2.4</b> Gestión Bases de Datos (5 statements)</a></li>
<li class="chapter" data-level="3.2.5" data-path="sintaxis-sql.html"><a href="sintaxis-sql.html#ejemplos-de-consultas-sql"><i class="fa fa-check"></i><b>3.2.5</b> Ejemplos de consultas SQL</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="conexion-con-bases-de-datos-desde-r.html"><a href="conexion-con-bases-de-datos-desde-r.html"><i class="fa fa-check"></i><b>3.3</b> Conexión con bases de datos desde R</a><ul>
<li class="chapter" data-level="3.3.1" data-path="conexion-con-bases-de-datos-desde-r.html"><a href="conexion-con-bases-de-datos-desde-r.html#introduccion-a-sql-en-r"><i class="fa fa-check"></i><b>3.3.1</b> Introducción a SQL en R</a></li>
<li class="chapter" data-level="3.3.2" data-path="conexion-con-bases-de-datos-desde-r.html"><a href="conexion-con-bases-de-datos-desde-r.html#el-paquete-sqldf"><i class="fa fa-check"></i><b>3.3.2</b> El paquete sqldf</a></li>
<li class="chapter" data-level="3.3.3" data-path="conexion-con-bases-de-datos-desde-r.html"><a href="conexion-con-bases-de-datos-desde-r.html#sql-queries"><i class="fa fa-check"></i><b>3.3.3</b> SQL Queries</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="ejemplo-scopus-data.html"><a href="ejemplo-scopus-data.html"><i class="fa fa-check"></i><b>3.4</b> Ejemplo Scopus data</a></li>
<li class="chapter" data-level="3.5" data-path="ejercicios-sql-con-rsqlite.html"><a href="ejercicios-sql-con-rsqlite.html"><i class="fa fa-check"></i><b>3.5</b> Ejercicios SQL con RSQLite</a><ul>
<li class="chapter" data-level="3.5.1" data-path="ejercicios-sql-con-rsqlite.html"><a href="ejercicios-sql-con-rsqlite.html#setup-de-rsqlite"><i class="fa fa-check"></i><b>3.5.1</b> Setup de RSQLite</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="practica-1-sql.html"><a href="practica-1-sql.html"><i class="fa fa-check"></i><b>3.6</b> Práctica 1: SQL</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="manipulacion-de-datos-con-dplyr.html"><a href="manipulacion-de-datos-con-dplyr.html"><i class="fa fa-check"></i><b>4</b> Manipulación de datos con <code>dplyr</code></a><ul>
<li class="chapter" data-level="4.1" data-path="el-paquete-dplyr.html"><a href="el-paquete-dplyr.html"><i class="fa fa-check"></i><b>4.1</b> El paquete <strong>dplyr</strong></a><ul>
<li class="chapter" data-level="4.1.1" data-path="el-paquete-dplyr.html"><a href="el-paquete-dplyr.html#datos-de-ejemplo"><i class="fa fa-check"></i><b>4.1.1</b> Datos de ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="operaciones-con-variables-columnas.html"><a href="operaciones-con-variables-columnas.html"><i class="fa fa-check"></i><b>4.2</b> Operaciones con variables (columnas)</a><ul>
<li class="chapter" data-level="4.2.1" data-path="operaciones-con-variables-columnas.html"><a href="operaciones-con-variables-columnas.html#seleccionar-variables-con-select"><i class="fa fa-check"></i><b>4.2.1</b> Seleccionar variables con <strong>select()</strong></a></li>
<li class="chapter" data-level="4.2.2" data-path="operaciones-con-variables-columnas.html"><a href="operaciones-con-variables-columnas.html#generar-nuevas-variables-con-mutate"><i class="fa fa-check"></i><b>4.2.2</b> Generar nuevas variables con <strong>mutate()</strong></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="operaciones-con-casos-filas.html"><a href="operaciones-con-casos-filas.html"><i class="fa fa-check"></i><b>4.3</b> Operaciones con casos (filas)</a><ul>
<li class="chapter" data-level="4.3.1" data-path="operaciones-con-casos-filas.html"><a href="operaciones-con-casos-filas.html#seleccionar-casos-con-filter"><i class="fa fa-check"></i><b>4.3.1</b> Seleccionar casos con <strong>filter()</strong></a></li>
<li class="chapter" data-level="4.3.2" data-path="operaciones-con-casos-filas.html"><a href="operaciones-con-casos-filas.html#organizar-casos-con-arrange"><i class="fa fa-check"></i><b>4.3.2</b> Organizar casos con <strong>arrange()</strong></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="resumir-valores-con-summarise.html"><a href="resumir-valores-con-summarise.html"><i class="fa fa-check"></i><b>4.4</b> Resumir valores con <strong>summarise()</strong></a></li>
<li class="chapter" data-level="4.5" data-path="agrupar-casos-con-group-by.html"><a href="agrupar-casos-con-group-by.html"><i class="fa fa-check"></i><b>4.5</b> Agrupar casos con <strong>group_by()</strong></a></li>
<li class="chapter" data-level="4.6" data-path="operador-pipe-tuberia-redireccion.html"><a href="operador-pipe-tuberia-redireccion.html"><i class="fa fa-check"></i><b>4.6</b> Operador <em>pipe</em> <strong>%&gt;%</strong> (tubería, redirección)</a></li>
<li class="chapter" data-level="4.7" data-path="operaciones-con-tablas-de-datos-1.html"><a href="operaciones-con-tablas-de-datos-1.html"><i class="fa fa-check"></i><b>4.7</b> Operaciones con tablas de datos</a></li>
<li class="chapter" data-level="4.8" data-path="bases-de-datos-con-dplyr.html"><a href="bases-de-datos-con-dplyr.html"><i class="fa fa-check"></i><b>4.8</b> Bases de datos con dplyr</a><ul>
<li class="chapter" data-level="4.8.1" data-path="bases-de-datos-con-dplyr.html"><a href="bases-de-datos-con-dplyr.html#ejemplos-practica-1"><i class="fa fa-check"></i><b>4.8.1</b> Ejemplos (Práctica 1)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introduccion-a-tecnologias-nosql.html"><a href="introduccion-a-tecnologias-nosql.html"><i class="fa fa-check"></i><b>5</b> Introducción a Tecnologías NoSQL</a><ul>
<li class="chapter" data-level="5.1" data-path="conceptos-y-tipos-de-bases-de-datos-nosql-documental-columnar-clavevalor-y-de-grafos.html"><a href="conceptos-y-tipos-de-bases-de-datos-nosql-documental-columnar-clavevalor-y-de-grafos.html"><i class="fa fa-check"></i><b>5.1</b> Conceptos y tipos de bases de datos NoSQL (documental, columnar, clave/valor y de grafos)</a><ul>
<li class="chapter" data-level="5.1.1" data-path="conceptos-y-tipos-de-bases-de-datos-nosql-documental-columnar-clavevalor-y-de-grafos.html"><a href="conceptos-y-tipos-de-bases-de-datos-nosql-documental-columnar-clavevalor-y-de-grafos.html#caracteristicas-de-las-bases-de-datos-nosql"><i class="fa fa-check"></i><b>5.1.1</b> Características de las bases de datos NoSQL</a></li>
<li class="chapter" data-level="5.1.2" data-path="conceptos-y-tipos-de-bases-de-datos-nosql-documental-columnar-clavevalor-y-de-grafos.html"><a href="conceptos-y-tipos-de-bases-de-datos-nosql-documental-columnar-clavevalor-y-de-grafos.html#tipos-de-bases-de-datos-nosql"><i class="fa fa-check"></i><b>5.1.2</b> Tipos de Bases de Datos NoSQL</a></li>
<li class="chapter" data-level="5.1.3" data-path="conceptos-y-tipos-de-bases-de-datos-nosql-documental-columnar-clavevalor-y-de-grafos.html"><a href="conceptos-y-tipos-de-bases-de-datos-nosql-documental-columnar-clavevalor-y-de-grafos.html#mongodb-nosql-documental"><i class="fa fa-check"></i><b>5.1.3</b> MongoDB: NoSQL documental</a></li>
<li class="chapter" data-level="5.1.4" data-path="conceptos-y-tipos-de-bases-de-datos-nosql-documental-columnar-clavevalor-y-de-grafos.html"><a href="conceptos-y-tipos-de-bases-de-datos-nosql-documental-columnar-clavevalor-y-de-grafos.html#redis-nosql-key-value"><i class="fa fa-check"></i><b>5.1.4</b> Redis: NoSQL key-value</a></li>
<li class="chapter" data-level="5.1.5" data-path="conceptos-y-tipos-de-bases-de-datos-nosql-documental-columnar-clavevalor-y-de-grafos.html"><a href="conceptos-y-tipos-de-bases-de-datos-nosql-documental-columnar-clavevalor-y-de-grafos.html#cassandra-nosql-columnar"><i class="fa fa-check"></i><b>5.1.5</b> Cassandra: NoSQL columnar</a></li>
<li class="chapter" data-level="5.1.6" data-path="conceptos-y-tipos-de-bases-de-datos-nosql-documental-columnar-clavevalor-y-de-grafos.html"><a href="conceptos-y-tipos-de-bases-de-datos-nosql-documental-columnar-clavevalor-y-de-grafos.html#neo4j-nosql-grafos"><i class="fa fa-check"></i><b>5.1.6</b> Neo4j: NoSQL grafos</a></li>
<li class="chapter" data-level="5.1.7" data-path="conceptos-y-tipos-de-bases-de-datos-nosql-documental-columnar-clavevalor-y-de-grafos.html"><a href="conceptos-y-tipos-de-bases-de-datos-nosql-documental-columnar-clavevalor-y-de-grafos.html#otros-search-engines"><i class="fa fa-check"></i><b>5.1.7</b> Otros: search engines</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="conexion-de-r-a-mongodb.html"><a href="conexion-de-r-a-mongodb.html"><i class="fa fa-check"></i><b>5.2</b> Conexión de R a MongoDB</a></li>
<li class="chapter" data-level="5.3" data-path="practica-2-nosql.html"><a href="practica-2-nosql.html"><i class="fa fa-check"></i><b>5.3</b> Práctica 2: NoSQL</a><ul>
<li class="chapter" data-level="5.3.1" data-path="practica-2-nosql.html"><a href="practica-2-nosql.html#ejercicios-con-rmongolite"><i class="fa fa-check"></i><b>5.3.1</b> Ejercicios con RMongolite</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="tecnologias-para-el-tratamiendo-de-datos-masivos.html"><a href="tecnologias-para-el-tratamiendo-de-datos-masivos.html"><i class="fa fa-check"></i><b>6</b> Tecnologías para el Tratamiendo de Datos Masivos</a><ul>
<li class="chapter" data-level="6.1" data-path="tecnologias-big-data-hadoop-spark-hive-rspark-sparklyr.html"><a href="tecnologias-big-data-hadoop-spark-hive-rspark-sparklyr.html"><i class="fa fa-check"></i><b>6.1</b> Tecnologías Big Data (Hadoop, Spark, Hive, Rspark, Sparklyr)</a><ul>
<li class="chapter" data-level="6.1.1" data-path="tecnologias-big-data-hadoop-spark-hive-rspark-sparklyr.html"><a href="tecnologias-big-data-hadoop-spark-hive-rspark-sparklyr.html#uso-de-hadoop-con-dos-ejemplos"><i class="fa fa-check"></i><b>6.1.1</b> Uso de Hadoop con dos ejemplos:</a></li>
<li class="chapter" data-level="6.1.2" data-path="tecnologias-big-data-hadoop-spark-hive-rspark-sparklyr.html"><a href="tecnologias-big-data-hadoop-spark-hive-rspark-sparklyr.html#uso-de-sparklyr"><i class="fa fa-check"></i><b>6.1.2</b> Uso de Sparklyr</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="visualizacion-y-generacion-de-cuadros-de-mando.html"><a href="visualizacion-y-generacion-de-cuadros-de-mando.html"><i class="fa fa-check"></i><b>6.2</b> Visualización y Generación de Cuadros de Mando</a></li>
<li class="chapter" data-level="6.3" data-path="introduccion-al-analisis-de-datos-masivos.html"><a href="introduccion-al-analisis-de-datos-masivos.html"><i class="fa fa-check"></i><b>6.3</b> Introducción al Análisis de Datos Masivos</a><ul>
<li class="chapter" data-level="6.3.1" data-path="introduccion-al-analisis-de-datos-masivos.html"><a href="introduccion-al-analisis-de-datos-masivos.html#rattle"><i class="fa fa-check"></i><b>6.3.1</b> Rattle</a></li>
<li class="chapter" data-level="6.3.2" data-path="introduccion-al-analisis-de-datos-masivos.html"><a href="introduccion-al-analisis-de-datos-masivos.html#combinando-los-distintos-elementos"><i class="fa fa-check"></i><b>6.3.2</b> Combinando los distintos elementos</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="practica-3-big-data.html"><a href="practica-3-big-data.html"><i class="fa fa-check"></i><b>6.4</b> Práctica 3: Big Data</a><ul>
<li class="chapter" data-level="6.4.1" data-path="practica-3-big-data.html"><a href="practica-3-big-data.html#ejercicio-a-con-sparklyr"><i class="fa fa-check"></i><b>6.4.1</b> Ejercicio A con sparklyr</a></li>
<li class="chapter" data-level="6.4.2" data-path="practica-3-big-data.html"><a href="practica-3-big-data.html#ejercicio-b-con-rattle"><i class="fa fa-check"></i><b>6.4.2</b> Ejercicio B con rattle</a></li>
<li class="chapter" data-level="6.4.3" data-path="practica-3-big-data.html"><a href="practica-3-big-data.html#ejercicio-c-con-sparklyr-y-hadoop"><i class="fa fa-check"></i><b>6.4.3</b> Ejercicio C con sparklyr y Hadoop</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Apendices</b></span></li>
<li class="chapter" data-level="A" data-path="links.html"><a href="links.html"><i class="fa fa-check"></i><b>A</b> Enlaces</a><ul>
<li class="chapter" data-level="A.1" data-path="rstudio-links.html"><a href="rstudio-links.html"><i class="fa fa-check"></i><b>A.1</b> RStudio</a></li>
<li class="chapter" data-level="A.2" data-path="bibliom-links.html"><a href="bibliom-links.html"><i class="fa fa-check"></i><b>A.2</b> Bibliometría</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="scimetr.html"><a href="scimetr.html"><i class="fa fa-check"></i><b>B</b> El paquete scimetr</a><ul>
<li class="chapter" data-level="B.1" data-path="instalacion.html"><a href="instalacion.html"><i class="fa fa-check"></i><b>B.1</b> Instalación</a></li>
<li class="chapter" data-level="B.2" data-path="carga-de-datos.html"><a href="carga-de-datos.html"><i class="fa fa-check"></i><b>B.2</b> Carga de datos</a><ul>
<li class="chapter" data-level="B.2.1" data-path="carga-de-datos.html"><a href="carga-de-datos.html#datos-de-ejemplo-1"><i class="fa fa-check"></i><b>B.2.1</b> Datos de ejemplo</a></li>
<li class="chapter" data-level="B.2.2" data-path="carga-de-datos.html"><a href="carga-de-datos.html#cargar-datos-de-directorio"><i class="fa fa-check"></i><b>B.2.2</b> Cargar datos de directorio</a></li>
</ul></li>
<li class="chapter" data-level="B.3" data-path="sumarios.html"><a href="sumarios.html"><i class="fa fa-check"></i><b>B.3</b> Sumarios</a><ul>
<li class="chapter" data-level="B.3.1" data-path="sumarios.html"><a href="sumarios.html#sumario-summary.wos.db"><i class="fa fa-check"></i><b>B.3.1</b> Sumario <code>summary.wos.db()</code></a></li>
<li class="chapter" data-level="B.3.2" data-path="sumarios.html"><a href="sumarios.html#sumario-por-anos-summary_year"><i class="fa fa-check"></i><b>B.3.2</b> Sumario por años <code>summary_year()</code></a></li>
</ul></li>
<li class="chapter" data-level="B.4" data-path="graficos.html"><a href="graficos.html"><i class="fa fa-check"></i><b>B.4</b> Gráficos</a><ul>
<li class="chapter" data-level="B.4.1" data-path="graficos.html"><a href="graficos.html#graficos-de-la-base-de-datos-plot.wos.db"><i class="fa fa-check"></i><b>B.4.1</b> Gráficos de la base de datos <code>plot.wos.db()</code></a></li>
<li class="chapter" data-level="B.4.2" data-path="graficos.html"><a href="graficos.html#graficos-sumario-plot.summary.wos.db"><i class="fa fa-check"></i><b>B.4.2</b> Gráficos sumario <code>plot.summary.wos.db()</code></a></li>
<li class="chapter" data-level="B.4.3" data-path="graficos.html"><a href="graficos.html#graficos-sumario-por-anos-plot.summary.year"><i class="fa fa-check"></i><b>B.4.3</b> Gráficos sumario por años <code>plot.summary.year()</code></a></li>
</ul></li>
<li class="chapter" data-level="B.5" data-path="filtrado-1.html"><a href="filtrado-1.html"><i class="fa fa-check"></i><b>B.5</b> Filtrado</a><ul>
<li class="chapter" data-level="B.5.1" data-path="filtrado-1.html"><a href="filtrado-1.html#funciones-get"><i class="fa fa-check"></i><b>B.5.1</b> Funciones get</a></li>
<li class="chapter" data-level="B.5.2" data-path="filtrado-1.html"><a href="filtrado-1.html#obtener-documentos-de-autores-revistas"><i class="fa fa-check"></i><b>B.5.2</b> Obtener documentos (de autores, revistas, …)</a></li>
<li class="chapter" data-level="B.5.3" data-path="filtrado-1.html"><a href="filtrado-1.html#sumarios-filtrados"><i class="fa fa-check"></i><b>B.5.3</b> Sumarios filtrados</a></li>
</ul></li>
<li class="chapter" data-level="B.6" data-path="indices-de-autores.html"><a href="indices-de-autores.html"><i class="fa fa-check"></i><b>B.6</b> Indices de autores</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="citan.html"><a href="citan.html"><i class="fa fa-check"></i><b>C</b> El paquete CITAN</a><ul>
<li class="chapter" data-level="C.1" data-path="creacion-de-la-base-de-datos.html"><a href="creacion-de-la-base-de-datos.html"><i class="fa fa-check"></i><b>C.1</b> Creación de la base de datos</a><ul>
<li class="chapter" data-level="C.1.1" data-path="creacion-de-la-base-de-datos.html"><a href="creacion-de-la-base-de-datos.html#primera-ejecucion-creacion-del-modelo-de-db"><i class="fa fa-check"></i><b>C.1.1</b> Primera ejecución: Creación del modelo de DB</a></li>
<li class="chapter" data-level="C.1.2" data-path="creacion-de-la-base-de-datos.html"><a href="creacion-de-la-base-de-datos.html#incorporar-nuevos-datos"><i class="fa fa-check"></i><b>C.1.2</b> Incorporar nuevos datos</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="extraer-informacion-de-la-bd.html"><a href="extraer-informacion-de-la-bd.html"><i class="fa fa-check"></i><b>C.2</b> Extraer información de la BD</a><ul>
<li class="chapter" data-level="C.2.1" data-path="extraer-informacion-de-la-bd.html"><a href="extraer-informacion-de-la-bd.html#estadisticos-descriptivos"><i class="fa fa-check"></i><b>C.2.1</b> Estadísticos descriptivos</a></li>
<li class="chapter" data-level="C.2.2" data-path="extraer-informacion-de-la-bd.html"><a href="extraer-informacion-de-la-bd.html#otra-informacion"><i class="fa fa-check"></i><b>C.2.2</b> Otra información</a></li>
</ul></li>
<li class="chapter" data-level="C.3" data-path="cerrar-conexion.html"><a href="cerrar-conexion.html"><i class="fa fa-check"></i><b>C.3</b> Cerrar conexión</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="introduccion-al-aprendizaje-estadistico.html"><a href="introduccion-al-aprendizaje-estadistico.html"><i class="fa fa-check"></i><b>D</b> Introducción al Aprendizaje Estadístico</a><ul>
<li class="chapter" data-level="D.1" data-path="data-science.html"><a href="data-science.html"><i class="fa fa-check"></i><b>D.1</b> Data Science</a><ul>
<li class="chapter" data-level="D.1.1" data-path="data-science.html"><a href="data-science.html#ventajas-e-inconvenientes"><i class="fa fa-check"></i><b>D.1.1</b> Ventajas e inconvenientes</a></li>
</ul></li>
<li class="chapter" data-level="D.2" data-path="metodos-de-aprendizaje-estadistico.html"><a href="metodos-de-aprendizaje-estadistico.html"><i class="fa fa-check"></i><b>D.2</b> Métodos de aprendizaje estadístico</a><ul>
<li class="chapter" data-level="D.2.1" data-path="metodos-de-aprendizaje-estadistico.html"><a href="metodos-de-aprendizaje-estadistico.html#metodos-de-aprendizaje-supervisado"><i class="fa fa-check"></i><b>D.2.1</b> Métodos (de aprendizaje supervisado):</a></li>
<li class="chapter" data-level="D.2.2" data-path="metodos-de-aprendizaje-estadistico.html"><a href="metodos-de-aprendizaje-estadistico.html#construccion-y-evaluacion-de-los-modelos"><i class="fa fa-check"></i><b>D.2.2</b> Construcción y evaluación de los modelos</a></li>
<li class="chapter" data-level="D.2.3" data-path="metodos-de-aprendizaje-estadistico.html"><a href="metodos-de-aprendizaje-estadistico.html#matriz-de-confusion"><i class="fa fa-check"></i><b>D.2.3</b> Matriz de confusión</a></li>
<li class="chapter" data-level="D.2.4" data-path="metodos-de-aprendizaje-estadistico.html"><a href="metodos-de-aprendizaje-estadistico.html#predicciones-frente-a-observado"><i class="fa fa-check"></i><b>D.2.4</b> Predicciones frente a observado</a></li>
</ul></li>
<li class="chapter" data-level="D.3" data-path="arboles-de-decision.html"><a href="arboles-de-decision.html"><i class="fa fa-check"></i><b>D.3</b> Arboles de decisión</a></li>
<li class="chapter" data-level="D.4" data-path="bagging-y-boosting.html"><a href="bagging-y-boosting.html"><i class="fa fa-check"></i><b>D.4</b> Bagging y Boosting</a><ul>
<li class="chapter" data-level="D.4.1" data-path="bagging-y-boosting.html"><a href="bagging-y-boosting.html#bagging-o-agregacion-bootstrap"><i class="fa fa-check"></i><b>D.4.1</b> Bagging o agregación Bootstrap</a></li>
<li class="chapter" data-level="D.4.2" data-path="bagging-y-boosting.html"><a href="bagging-y-boosting.html#bosques-aleatorios"><i class="fa fa-check"></i><b>D.4.2</b> Bosques Aleatorios</a></li>
<li class="chapter" data-level="D.4.3" data-path="bagging-y-boosting.html"><a href="bagging-y-boosting.html#boosting"><i class="fa fa-check"></i><b>D.4.3</b> Boosting</a></li>
</ul></li>
<li class="chapter" data-level="D.5" data-path="support-vector-machines-svm.html"><a href="support-vector-machines-svm.html"><i class="fa fa-check"></i><b>D.5</b> Support vector machines (SVM)</a></li>
<li class="chapter" data-level="D.6" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html"><i class="fa fa-check"></i><b>D.6</b> Modelos lineales (generalizados)</a></li>
<li class="chapter" data-level="D.7" data-path="metodos-de-regularizacion.html"><a href="metodos-de-regularizacion.html"><i class="fa fa-check"></i><b>D.7</b> Métodos de regularización</a><ul>
<li class="chapter" data-level="D.7.1" data-path="metodos-de-regularizacion.html"><a href="metodos-de-regularizacion.html#ridge-regression"><i class="fa fa-check"></i><b>D.7.1</b> Ridge Regression</a></li>
<li class="chapter" data-level="D.7.2" data-path="metodos-de-regularizacion.html"><a href="metodos-de-regularizacion.html#lasso"><i class="fa fa-check"></i><b>D.7.2</b> Lasso</a></li>
</ul></li>
<li class="chapter" data-level="D.8" data-path="regresion-no-parametrica.html"><a href="regresion-no-parametrica.html"><i class="fa fa-check"></i><b>D.8</b> Regresión no paramétrica</a><ul>
<li class="chapter" data-level="D.8.1" data-path="regresion-no-parametrica.html"><a href="regresion-no-parametrica.html#modelos-aditivos"><i class="fa fa-check"></i><b>D.8.1</b> Modelos aditivos</a></li>
</ul></li>
<li class="chapter" data-level="D.9" data-path="redes-neuronales.html"><a href="redes-neuronales.html"><i class="fa fa-check"></i><b>D.9</b> Redes neuronales</a></li>
<li class="chapter" data-level="D.10" data-path="bibliografia.html"><a href="bibliografia.html"><i class="fa fa-check"></i><b>D.10</b> Bibliografía</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Prácticas de Tecnologías de Gestión y Manipulación de Datos</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tecnologias-big-data-hadoop-spark-hive-rspark-sparklyr" class="section level2">
<h2><span class="header-section-number">6.1</span> Tecnologías Big Data (Hadoop, Spark, Hive, Rspark, Sparklyr)</h2>
<p>A continuación se introducen los conceptos básicos de las tecnologías Big Data:</p>
<ul>
<li><p>Hadoop: framework open-source desarrollado en Java principalmente que soporta aplicaciones distribuidas sobre miles de nodos y a escala Petabyte. Está inspierado en el diseño de las operaciones de MapReduce de Google y el Google File System (GFS). Entre sus principales componentes destaca HDFS Hadoop Distributed File System, sistema de ficheros distribuido sobre múltiples nodos y accesible a nivel de aplicación. También destaca YARN como gestor de recursos, para ejecutar aplicaciones. Destacar que la versión original, Hadoop 1, estaba basada extensivamente en Map Reduce, Hadoop 2 colocó en su core a YARN y Hadoop 3 está orientado a la provisión de Plataforma como servicio y ejecución simultánea de múltiples cargas de trabajo distribuidas sobre recursos solicitados bajo demanda.</p></li>
<li><p>Hive: es un sistema de almancenamiento y explotación de datos del estilo de un data warehouse open source diseñado para ser ejecutado en entornos Hadoop. Permite agrupar, consultar y analizar datos almacenados en Hadoop File System y en Amazon S3 (almacenamiento de objetos en general) en esquema en estrella. Su lenguaje de consulta de datos, Hive Query Language o (HQL).</p></li>
<li><p>Spark: framework de computación distribuida open-source para el procesamiento de datos masivos sobre Hadoop con un paralelismo implícito sobre su estructura de datos (Resilient Distributed Dataset o RDD), permite operar en paralelo sobre una colección de datos sin saber en qué servidores están disponibles dichos datos y de una forma tolerante a fallos. Es uno de los principales frameworks de programación de entornos Hadoop al estar optimizado su procesamiento sobre memoria (en lugar de sobre archivos en disco) para obtener velocidad, tanto en sus vertientes Spark streaming y Spark SQL, como Spark Machile Learning MLlib. Dispone de interfaces en Java, Scala, Python y R, siendo las interfaces de R Rspark y Sparklyr.</p></li>
<li><p>SparkR: es un paquete, el primero que apareció, para conectar R con Spark. Intenta ser lo más parecida a la interfaz estándard de R de manipulación de datos.</p></li>
<li><p>Sparklyr: es una librería para conectar R con Spark posterior a SparkR. Intenta ser lo más parecida a dplyr y embeber SQL en las consultas, soportando una mayor cantidad de paquetes. Por este motivo es el proyecto más activo actualmente, sustituyendo a SparkR.</p></li>
</ul>
<p><img src="images/T3-ecosistema.png" /></p>
<div id="uso-de-hadoop-con-dos-ejemplos" class="section level3">
<h3><span class="header-section-number">6.1.1</span> Uso de Hadoop con dos ejemplos:</h3>
<p>Conexión vía SSH a CESGA (siempre con VPN activada!) y ejemplo #1:</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb230-1" title="1">wget  https<span class="op">:</span><span class="er">//</span>packages.revolutionanalytics.com<span class="op">/</span>datasets<span class="op">/</span>claims2.csv </a>
<a class="sourceLine" id="cb230-2" title="2"></a>
<a class="sourceLine" id="cb230-3" title="3"><span class="co"># [3 minutos – 1GB/minuto en CESGA]  [recomendada la descarga desde servidor dtn.srv.cesga.es] [copia temp /tmp]</span></a>
<a class="sourceLine" id="cb230-4" title="4"></a>
<a class="sourceLine" id="cb230-5" title="5">hadoop fs –mkdir p1<span class="op">/</span></a>
<a class="sourceLine" id="cb230-6" title="6">hadoop fs <span class="op">-</span>mkdir p1<span class="op">/</span>claims<span class="op">/</span></a>
<a class="sourceLine" id="cb230-7" title="7">hadoop fs –put claims2.csv p1<span class="op">/</span>claims<span class="op">/</span><span class="st">   </span>[<span class="dv">3</span> segundos]</a>
<a class="sourceLine" id="cb230-8" title="8">hadoop fs –ls p1<span class="op">/</span>claims<span class="op">/</span></a>
<a class="sourceLine" id="cb230-9" title="9"></a>
<a class="sourceLine" id="cb230-10" title="10"><span class="er">$</span><span class="st"> </span>myquota</a>
<a class="sourceLine" id="cb230-11" title="11"><span class="co"># [1TB en $HOMEBD y 18TB en Hadoop]</span></a>
<a class="sourceLine" id="cb230-12" title="12"></a>
<a class="sourceLine" id="cb230-13" title="13"><span class="op">$</span><span class="st"> </span>spark<span class="op">-</span>shell <span class="op">--</span>packages com.databricks<span class="op">:</span>spark<span class="op">-</span>csv_<span class="fl">2.10</span><span class="op">:</span><span class="dv">1</span>.<span class="fl">4.0</span></a>
<a class="sourceLine" id="cb230-14" title="14"><span class="op">&gt;</span><span class="st"> </span>val sqlContext =<span class="st"> </span>new <span class="kw">org.apache.spark.sql.SQLContext</span>(sc); </a>
<a class="sourceLine" id="cb230-15" title="15"><span class="op">&gt;</span><span class="st"> </span>val df =<span class="st"> </span><span class="kw">sqlContext.read.format</span>(csv)<span class="kw">.option</span>(header, true)<span class="kw">.load</span>(p1<span class="op">/</span>claims<span class="op">/</span>claims2.csv)</a>
<a class="sourceLine" id="cb230-16" title="16"><span class="op">&gt;</span><span class="st"> </span><span class="kw">df.count</span>();  <span class="kw">df.first</span>();  <span class="kw">df.take</span>(<span class="dv">5</span>);  <span class="kw">df.printSchema</span>();</a>
<a class="sourceLine" id="cb230-17" title="17"><span class="op">&gt;</span><span class="st"> </span><span class="kw">df.registerTempTable</span>(TblName)</a>
<a class="sourceLine" id="cb230-18" title="18"><span class="op">&gt;</span><span class="st"> </span><span class="kw">sqlContext.sql</span>(select <span class="op">*</span><span class="st"> </span>from TblName limit <span class="dv">100</span>)<span class="kw">.take</span>(<span class="dv">100</span>)<span class="kw">.foreach</span>(println)</a>
<a class="sourceLine" id="cb230-19" title="19"><span class="op">&gt;</span><span class="st"> </span><span class="kw">sqlContext.sql</span>(select <span class="op">*</span><span class="st"> </span>from TblName where <span class="dt">Calendar_year=</span><span class="dv">2005</span>)<span class="kw">.count</span>()</a></code></pre></div>
<p>Usando Spark-shell pero también podemos realizar ciertos análisis con hive:</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb231-1" title="1"><span class="op">$</span><span class="st"> </span>hadoop fs <span class="op">-</span>mkdir bdp</a>
<a class="sourceLine" id="cb231-2" title="2"><span class="op">$</span><span class="st"> </span>hadoop fs <span class="op">-</span>mkdir bdp<span class="op">/</span>hv_csv_table</a>
<a class="sourceLine" id="cb231-3" title="3"><span class="op">$</span><span class="st"> </span>hadoop fs <span class="op">-</span>mkdir bdp<span class="op">/</span>hv_csv_table<span class="op">/</span>ip</a>
<a class="sourceLine" id="cb231-4" title="4"><span class="op">$</span><span class="st"> </span>hadoop fs <span class="op">-</span>put claims2.csv bdp<span class="op">/</span>hv_csv_table<span class="op">/</span>ip</a>
<a class="sourceLine" id="cb231-5" title="5"></a>
<a class="sourceLine" id="cb231-6" title="6"><span class="op">$</span><span class="st"> </span>hive      OR   <span class="op">$</span><span class="st"> </span><span class="kw">beeline</span> (recomendado este último por seguridad pero por simplicidad usamos hive en CESGA)</a>
<a class="sourceLine" id="cb231-7" title="7"></a>
<a class="sourceLine" id="cb231-8" title="8">CREATE SCHEMA IF NOT EXISTS bdp;</a>
<a class="sourceLine" id="cb231-9" title="9">CREATE EXTERNAL TABLE IF NOT EXISTS <span class="kw">bdp.hv_csv_table</span> (Row_ID STRING, Household_ID STRING, Vehicle STRING, Calendar_Year STRING, Model_Year STRING, Blind_Make STRING, Blind_Model STRING, Blind_Submodel STRING, Cat1 STRING, Cat2 STRING, Cat3 STRING, Cat4 STRING, Cat5 STRING, Cat6 STRING, Cat7 STRING, Cat8 STRING, Cat9 STRING, Cat10 STRING, Cat11 STRING, Cat12 STRING, OrdCat STRING, Var1 STRING, Var2 STRING, Var3 STRING, Var4 STRING, Var5 STRING, Var6 STRING, Var7 STRING, Var8 STRING, NVCat STRING, NVVar1 STRING, NVVar2 STRING, NVVar3 STRING, NVVar4 STRING, Claim_Amount STRING, veh_age STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY <span class="st">&#39;,&#39;</span> STORED AS TEXTFILE LOCATION <span class="st">&#39;hdfs://nameservice1/user/cursoXXX/p1/claims/&#39;</span>;</a>
<a class="sourceLine" id="cb231-10" title="10"></a>
<a class="sourceLine" id="cb231-11" title="11">SELECT <span class="op">*</span><span class="st"> </span>FROM bdp.hv_csv_table LIMIT <span class="dv">10</span>;</a>
<a class="sourceLine" id="cb231-12" title="12">SELECT <span class="op">*</span><span class="st"> </span>FROM bdp.hv_csv_table where Calendar_Year=<span class="dv">2005</span> limit <span class="dv">10</span>;</a>
<a class="sourceLine" id="cb231-13" title="13">SELECT <span class="op">*</span><span class="st"> </span>FROM bdp.hv_csv_table where Calendar_Year<span class="op">&gt;</span><span class="dv">2005</span>;</a></code></pre></div>
<p>Y ejemplo #2:</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb232-1" title="1"><span class="co"># Generación de un archivo spanishTexts-ALL y 120-million-word-spanish-corpus.zip  </span></a>
<a class="sourceLine" id="cb232-2" title="2"><span class="co"># Origen: https://www.kaggle.com/rtatman/120-million-word-spanish-corpus</span></a>
<a class="sourceLine" id="cb232-3" title="3">hadoop fs –mkdir p2</a>
<a class="sourceLine" id="cb232-4" title="4">hadoop fs <span class="op">-</span>put <span class="dv">120</span><span class="op">-</span>million<span class="op">-</span>word<span class="op">-</span>spanish<span class="op">-</span>corpus.zip p2</a>
<a class="sourceLine" id="cb232-5" title="5"></a>
<a class="sourceLine" id="cb232-6" title="6"><span class="op">$</span><span class="st"> </span>spark<span class="op">-</span>shell</a>
<a class="sourceLine" id="cb232-7" title="7"><span class="co"># map</span></a>
<a class="sourceLine" id="cb232-8" title="8">var map =<span class="st"> </span><span class="kw">sc.textFile</span>(p2<span class="op">/</span>spanishTest<span class="op">-</span>ALL)<span class="kw">.flatMap</span>(<span class="dt">line =</span><span class="op">&gt;</span><span class="st"> </span><span class="kw">line.split</span>( ))<span class="kw">.map</span>(<span class="dt">word =</span><span class="op">&gt;</span><span class="st"> </span>(word,<span class="dv">1</span>));</a>
<a class="sourceLine" id="cb232-9" title="9"><span class="co"># reduce</span></a>
<a class="sourceLine" id="cb232-10" title="10">var counts =<span class="st"> </span><span class="kw">map.reduceByKey</span>(_ <span class="op">+</span><span class="st"> </span>_);</a>
<a class="sourceLine" id="cb232-11" title="11"><span class="co"># save the output to file, every time a different directory!!!</span></a>
<a class="sourceLine" id="cb232-12" title="12"><span class="kw">counts.saveAsTextFile</span>(p2<span class="op">/</span>output)</a>
<a class="sourceLine" id="cb232-13" title="13"><span class="kw">counts.count</span>() <span class="kw">counts.first</span>() <span class="kw">counts.take</span>(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb232-14" title="14"><span class="co"># from word -&gt; num to num -&gt; word</span></a>
<a class="sourceLine" id="cb232-15" title="15"><span class="co"># then sortBy num of occurrence in descending order </span></a>
<a class="sourceLine" id="cb232-16" title="16">val mostCommon =<span class="st"> </span><span class="kw">counts.map</span>(<span class="dt">p =</span><span class="op">&gt;</span><span class="st"> </span>(p._<span class="dv">2</span>, p._<span class="dv">1</span>))<span class="kw">.sortByKey</span>(false, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb232-17" title="17"><span class="kw">mostCommon.take</span>(<span class="dv">50</span>)</a></code></pre></div>
</div>
<div id="uso-de-sparklyr" class="section level3">
<h3><span class="header-section-number">6.1.2</span> Uso de Sparklyr</h3>
<p>Conexión vía SSH a CESGA (siempre con VPN activada!) y una vez dentro “module load sparklyr” y arrancar R:</p>
<p><img src="images/T3-sparklyr1.png" /></p>
<p>O alternativamente mediante jupyterlab. Para ello hacemos los dos primeros pasos del apartado anterior, conexión vía SSH a CESGA (siempre con VPN activada!) y una vez dentro “module load sparklyr”. Y a continuación escribimos “start-jupyter-lab” y nos conectamos a la URL indicada, desde la cual tendremos acceso a los notebooks Python/R:</p>
<p><img src="images/T3-sparklyr2.png" /></p>
<p>Y dentro del notebook R ya se puede probar el funcionamiento de Sparklyr con los siguientes pasos, cuyo resultado debería ser el que se aprecia a continuación:</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb233-1" title="1"><span class="kw">library</span>(sparklyr)</a>
<a class="sourceLine" id="cb233-2" title="2">sc &lt;-<span class="st"> </span><span class="kw">spark_connect</span>(<span class="dt">master =</span> <span class="st">&quot;yarn-client&quot;</span>, <span class="dt">spark_home =</span> <span class="kw">Sys.getenv</span>(<span class="st">&#39;SPARK_HOME&#39;</span>)) </a>
<a class="sourceLine" id="cb233-3" title="3">iris_tbl &lt;-<span class="st"> </span><span class="kw">copy_to</span>(sc, iris, <span class="st">&quot;iris&quot;</span>, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb233-4" title="4">iris_tbl</a></code></pre></div>
<p><img src="images/T3-sparklyr3.png" /></p>
<p>NOTA: en ausencia de clúster Hadoop con YARN, o para debugging, también se puede conectar usando las siguientes instrucciones, y obtener elm mismo resultado que en presencia de YARN.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb234-1" title="1"><span class="kw">library</span>(sparklyr)</a>
<a class="sourceLine" id="cb234-2" title="2">sc &lt;-<span class="st"> </span><span class="kw">spark_connect</span>(<span class="dt">master =</span> <span class="st">&quot;local&quot;</span>)</a>
<a class="sourceLine" id="cb234-3" title="3">iris_tbl &lt;-<span class="st"> </span><span class="kw">copy_to</span>(sc, iris, <span class="st">&quot;iris&quot;</span>, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb234-4" title="4">iris_tbl</a></code></pre></div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tecnologias-para-el-tratamiendo-de-datos-masivos.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="visualizacion-y-generacion-de-cuadros-de-mando.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/gltaboada/tgdbook/edit/master/06-Hadoop.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["Practicas_de_TGD.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
